<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>โพสต์ที่บันทึกไว้</title>
  <link rel="stylesheet" href="/style.css"/>
  <style>
    :root{
      --brand:#0d63a5;
      --brand-2:#0b4f85;
      --muted:#6b7280;
      --ink:#111827;
      --card:#ffffff;
      --bg:#f8fafc;
      --border:#e5e7eb;
    }
    body{ background:var(--bg); }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 16px;
    }

    .page-head{
      display:flex; align-items:baseline; justify-content:space-between;
      gap: 12px; margin-bottom: 12px;
    }
    .page-title{
      margin:0; color:#0f3d7a; font-size: clamp(1.25rem, 2.5vw, 1.6rem);
      font-weight: 800;
    }
    .count{
      color:var(--muted); font-size:.95rem;
    }

    /* grid */
    .saved-grid{
      display:grid;
      gap: 16px;
      grid-template-columns: 1fr;
    }
    @media (min-width: 560px){
      .saved-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (min-width: 960px){
      .saved-grid{ grid-template-columns: repeat(3, minmax(0,1fr)); }
    }

    /* card */
    .saved-card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      box-shadow: 0 4px 14px rgba(2,6,23, .05);
      overflow:hidden;
      display:flex; flex-direction:column;
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .saved-card:hover{
      transform: translateY(-3px);
      border-color:#cfe8ff;
      box-shadow: 0 12px 26px rgba(13,99,165,.12);
    }

    /* media (16:9) */
    .thumb{
      position:relative; width:100%;
      aspect-ratio: 16 / 9; /* fallback modern */
      background: linear-gradient(135deg,#e5f3ff, #f1f5f9);
    }
    .thumb img{
      position:absolute; inset:0; width:100%; height:100%;
      object-fit:cover; display:block;
    }

    /* body */
    .saved-body{ padding: 12px 14px; display:flex; flex-direction:column; gap:10px; }
    .saved-title{ margin:0; font-size:1.02rem; line-height:1.35; }
    .saved-title a{
      text-decoration:none; color:var(--ink); font-weight:800;
    }
    .saved-title a:hover{ color:var(--brand); }

    .meta{
      color:var(--muted);
      display:flex; align-items:center; gap:10px; flex-wrap:wrap;
      font-size:.92rem;
    }
    .meta svg{ width:16px; height:16px; vertical-align:middle; color:#6b7280; }

    .tags{ display:flex; flex-wrap:wrap; gap:6px; }
    .tag{
      display:inline-flex; align-items:center; gap:6px;
      padding: 2px 8px; border-radius:999px; font-size:.72rem; font-weight:700;
      border:1px solid #bae6fd; background:#e0f2fe; color:#075985;
    }

    /* footer actions */
    .card-foot{
      margin-top:auto;
      padding: 10px 14px 14px;
      display:flex; align-items:center; justify-content:flex-end; gap:8px;
    }
    .unsave-btn{
      padding: 8px 12px;
      border: 1px solid #dc2626;
      background: #fee2e2;
      color: #b91c1c;
      border-radius: 10px;
      cursor: pointer;
      transition: filter .15s ease, transform .04s ease;
    }
    .unsave-btn:hover{ background:#fecaca; }
    .unsave-btn:active{ transform: translateY(1px); }

    /* empty state */
    .empty{
      margin: 28px 0;
      text-align:center; color:var(--muted);
    }
    .empty-card{
      max-width:720px; margin: 0 auto; padding: 22px;
      background: var(--card); border:1px dashed #dbeafe; border-radius:14px;
    }
    .empty h3{ margin:0 0 6px; color:#0f3d7a; }
    .cta{
      margin-top:10px; display:inline-block; text-decoration:none;
      background:var(--brand); color:#fff; border:1px solid var(--brand);
      padding:10px 14px; border-radius:10px;
    }
    .cta:hover{ background:var(--brand-2); border-color:var(--brand-2); }
  </style>
</head>
<body>
  <main class="wrap">
    <div class="page-head">
      <h1 class="page-title">โพสต์ที่บันทึกไว้</h1>
      <span class="count"><%= (savedPosts && savedPosts.length) ? savedPosts.length + ' รายการ' : '' %></span>
    </div>

    <% if (!savedPosts || savedPosts.length === 0){ %>
      <div class="empty">
        <div class="empty-card">
          <h3>ยังไม่มีโพสต์ที่บันทึก</h3>
          <p>ไปดูสรุปหรือบทความ แล้วกด “บันทึกโพสต์” ไว้อ่านภายหลังได้เลย</p>
          <a class="cta" href="/">กลับหน้าแรก</a>
        </div>
      </div>
    <% } else { %>
      <ul class="saved-grid">
        <% savedPosts.forEach(post => { %>
          <li class="saved-card">
            <a class="thumb" href="/posts/<%= post.slug %>" aria-label="เปิด: <%= post.title %>">
              <% if (post.coverImage){ %>
                <img src="<%= post.coverImage %>" alt="">
              <% } %>
            </a>

            <div class="saved-body">
              <h3 class="saved-title">
                <a href="/posts/<%= post.slug %>"><%= post.title %></a>
              </h3>

              <div class="meta">
                <span>by <%= post.author?.username %></span>
                <span style="display:inline-flex;align-items:center;gap:6px;">
                  <svg viewBox="0 0 16 16" aria-hidden="true">
                    <path d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                  </svg><%= post.likes.length %>
                </span>
                <span style="display:inline-flex;align-items:center;gap:6px;">
                  <svg viewBox="0 0 16 16" aria-hidden="true">
                    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/><path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/>
                  </svg><%= post.views %>
                </span>
              </div>

              <% if (post.tags && post.tags.length){ %>
                <div class="tags">
                  <% post.tags.forEach(tag => { %>
                    <span class="tag"><%= tag %></span>
                  <% }) %>
                </div>
              <% } %>
            </div>

            <div class="card-foot">
              <button type="button" class="unsave-btn" data-slug="<%= post.slug %>">ยกเลิกบันทึก</button>
            </div>
          </li>
        <% }) %>
      </ul>
    <% } %>
  </main>

  <!-- สคริปต์เดิมของคุณที่มี event delegation บน .unsave-btn -->
  <script src="/js/save-post.js"></script>
</body>
</html>
